diff --git a/.idea/workspace.xml b/.idea/workspace.xml
index 3ab3d13..4e42977 100644
--- a/.idea/workspace.xml
+++ b/.idea/workspace.xml
@@ -3,12 +3,14 @@
   <component name="ChangeListManager">
     <list default="true" id="3c26d431-2fbc-4e13-8f9b-affc3b8083c3" name="Default Changelist" comment="">
       <change beforePath="$PROJECT_DIR$/.gitignore" beforeDir="false" afterPath="$PROJECT_DIR$/.gitignore" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/tracking/network.py" beforeDir="false" afterPath="$PROJECT_DIR$/tracking/network.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/tracking/reports/RGBT/RGB/SiamRPN/performance.json" beforeDir="false" afterPath="$PROJECT_DIR$/tracking/reports/RGBT/RGB/SiamRPN/performance.json" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/tracking/run_tracking.py" beforeDir="false" afterPath="$PROJECT_DIR$/tracking/run_tracking.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/train/data_rgbt.py" beforeDir="false" afterPath="$PROJECT_DIR$/train/data_rgbt.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/train/net.py" beforeDir="false" afterPath="$PROJECT_DIR$/train/net.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/train/train.py" beforeDir="false" afterPath="$PROJECT_DIR$/train/train.py" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/train/wandb/debug.log" beforeDir="false" afterPath="$PROJECT_DIR$/train/wandb/debug.log" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/train/wandb/settings" beforeDir="false" afterPath="$PROJECT_DIR$/train/wandb/settings" afterDir="false" />
     </list>
     <option name="EXCLUDED_CONVERTED_TO_IGNORED" value="true" />
     <option name="SHOW_DIALOG" value="false" />
@@ -21,8 +23,23 @@
       <file pinned="false" current-in-tab="true">
         <entry file="file://$PROJECT_DIR$/train/train.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="340">
-              <caret line="20" lean-forward="true" selection-start-line="20" selection-end-line="20" />
+            <state relative-caret-position="338">
+              <caret line="49" column="60" lean-forward="true" selection-start-line="49" selection-start-column="60" selection-end-line="49" selection-end-column="60" />
+              <folding>
+                <element signature="e#24#33#0" expanded="true" />
+              </folding>
+            </state>
+          </provider>
+        </entry>
+      </file>
+      <file pinned="false" current-in-tab="false">
+        <entry file="file://$PROJECT_DIR$/train/experimentrgbt.py">
+          <provider selected="true" editor-type-id="text-editor">
+            <state relative-caret-position="230">
+              <caret line="158" column="12" selection-start-line="158" selection-start-column="12" selection-end-line="158" selection-end-column="12" />
+              <folding>
+                <element signature="e#0#64#0" expanded="true" />
+              </folding>
             </state>
           </provider>
         </entry>
@@ -30,8 +47,8 @@
       <file pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/tracking/run_tracking.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="238">
-              <caret line="14" column="38" lean-forward="true" selection-start-line="14" selection-start-column="38" selection-end-line="14" selection-end-column="38" />
+            <state relative-caret-position="272">
+              <caret line="16" selection-start-line="10" selection-start-column="3" selection-end-line="16" />
               <folding>
                 <element signature="e#0#38#0" expanded="true" />
               </folding>
@@ -43,7 +60,7 @@
         <entry file="file://$PROJECT_DIR$/train/data_rgbt.py">
           <provider selected="true" editor-type-id="text-editor">
             <state relative-caret-position="34">
-              <caret line="2" column="10" lean-forward="true" selection-start-line="2" selection-start-column="10" selection-end-line="2" selection-end-column="10" />
+              <caret line="2" column="10" selection-start-line="2" selection-start-column="10" selection-end-line="2" selection-end-column="10" />
             </state>
           </provider>
         </entry>
@@ -51,8 +68,8 @@
       <file pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/train/net.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="-499">
-              <caret line="186" column="25" lean-forward="true" selection-start-line="186" selection-start-column="25" selection-end-line="186" selection-end-column="25" />
+            <state relative-caret-position="253">
+              <caret line="95" selection-start-line="95" selection-end-line="98" selection-end-column="82" />
               <folding>
                 <element signature="e#0#9#0" expanded="true" />
               </folding>
@@ -64,7 +81,7 @@
         <entry file="file://$PROJECT_DIR$/tracking/SiamRPNEval.py">
           <provider selected="true" editor-type-id="text-editor">
             <state relative-caret-position="102">
-              <caret line="125" column="18" lean-forward="true" selection-start-line="125" selection-start-column="18" selection-end-line="125" selection-end-column="18" />
+              <caret line="125" column="18" selection-start-line="125" selection-start-column="18" selection-end-line="125" selection-end-column="18" />
               <folding>
                 <element signature="e#0#10#0" expanded="true" />
                 <element signature="e#818#3658#0" />
@@ -76,8 +93,11 @@
       <file pinned="false" current-in-tab="false">
         <entry file="file://$PROJECT_DIR$/tracking/network.py">
           <provider selected="true" editor-type-id="text-editor">
-            <state relative-caret-position="68">
-              <caret line="4" selection-start-line="4" selection-end-line="4" />
+            <state relative-caret-position="323">
+              <caret line="64" column="30" selection-start-line="64" selection-start-column="30" selection-end-line="64" selection-end-column="30" />
+              <folding>
+                <element signature="e#0#12#0" expanded="true" />
+              </folding>
             </state>
           </provider>
         </entry>
@@ -93,9 +113,6 @@
   </component>
   <component name="FindInProjectRecents">
     <findStrings>
-      <find>class SiamRp</find>
-      <find>rgbtda</find>
-      <find>totens</find>
       <find>tracker_pat</find>
       <find>SiameseAlexNet</find>
       <find>reports</find>
@@ -123,6 +140,9 @@
       <find>self.experiment_name</find>
       <find>custom</find>
       <find>TrackerSiamRPN</find>
+      <find>net_path</find>
+      <find>_curves</find>
+      <find>exp_name_dir</find>
     </findStrings>
   </component>
   <component name="Git.Settings">
@@ -144,13 +164,13 @@
         <option value="$PROJECT_DIR$/tracking/data_loader.py" />
         <option value="$PROJECT_DIR$/train/custom_transforms.py" />
         <option value="$PROJECT_DIR$/util/__init__.py" />
-        <option value="$PROJECT_DIR$/tracking/network.py" />
         <option value="$PROJECT_DIR$/tracking/SiamRPNEval.py" />
         <option value="$PROJECT_DIR$/README.md" />
         <option value="$PROJECT_DIR$/tracking/run_tracking.py" />
         <option value="$PROJECT_DIR$/train/data_rgbt.py" />
         <option value="$PROJECT_DIR$/train/__init__.py" />
         <option value="$PROJECT_DIR$/train/net.py" />
+        <option value="$PROJECT_DIR$/tracking/network.py" />
         <option value="$PROJECT_DIR$/train/train.py" />
       </list>
     </option>
@@ -176,12 +196,13 @@
             <path>
               <item name="SiamRPN-PyTorch" type="b2602c69:ProjectViewProjectNode" />
               <item name="SiamRPN-PyTorch" type="462c0819:PsiDirectoryNode" />
-              <item name="tracking" type="462c0819:PsiDirectoryNode" />
+              <item name="experiments" type="462c0819:PsiDirectoryNode" />
             </path>
             <path>
               <item name="SiamRPN-PyTorch" type="b2602c69:ProjectViewProjectNode" />
               <item name="SiamRPN-PyTorch" type="462c0819:PsiDirectoryNode" />
-              <item name="train" type="462c0819:PsiDirectoryNode" />
+              <item name="experiments" type="462c0819:PsiDirectoryNode" />
+              <item name="SiamRPN_RGB" type="462c0819:PsiDirectoryNode" />
             </path>
           </expand>
           <select />
@@ -200,6 +221,7 @@
       <recent name="$PROJECT_DIR$/tracking" />
     </key>
     <key name="CopyFile.RECENT_KEYS">
+      <recent name="$PROJECT_DIR$/experiments" />
       <recent name="$PROJECT_DIR$/train" />
       <recent name="$PROJECT_DIR$/train/experiments" />
       <recent name="$PROJECT_DIR$/tracking" />
@@ -217,7 +239,7 @@
       </list>
     </option>
   </component>
-  <component name="RunManager" selected="Python.run_tracking">
+  <component name="RunManager" selected="Python.train RPN RGB">
     <configuration name="Train RPNG RGB + RGB+IR" type="Multirun" factoryName="Multirun" separateTabs="true" startOneByOne="true" markFailedProcess="true" hideSuccessProcess="false" delayTime="1">
       <runConfiguration name="train RPN RGB" type="Python" />
       <runConfiguration name="train RPN RGB + IR" type="Python" />
@@ -298,7 +320,7 @@
         <env name="CUDA_VISIBLE_DEVICES" value="0" />
       </envs>
       <option name="SDK_HOME" value="/usr/bin/python3.5" />
-      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$/train" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
       <option name="IS_MODULE_SDK" value="false" />
       <option name="ADD_CONTENT_ROOTS" value="true" />
       <option name="ADD_SOURCE_ROOTS" value="true" />
@@ -538,16 +560,6 @@
     <entry file="file://$PROJECT_DIR$/tracking/reports/RGBT/RGBT-Train/SiamRPN/success_plot.png">
       <provider selected="true" editor-type-id="images" />
     </entry>
-    <entry file="file://$PROJECT_DIR$/train/experimentrgbt.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="780">
-          <caret line="101" column="28" selection-start-line="101" selection-start-column="28" selection-end-line="101" selection-end-column="28" />
-          <folding>
-            <element signature="e#0#64#0" expanded="true" />
-          </folding>
-        </state>
-      </provider>
-    </entry>
     <entry file="file://$PROJECT_DIR$/fixed.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="238">
@@ -622,13 +634,6 @@
         </state>
       </provider>
     </entry>
-    <entry file="file://$PROJECT_DIR$/tracking/network.py">
-      <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="68">
-          <caret line="4" selection-start-line="4" selection-end-line="4" />
-        </state>
-      </provider>
-    </entry>
     <entry file="file://$PROJECT_DIR$/../.local/lib/python3.5/site-packages/torch/serialization.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="57">
@@ -649,7 +654,7 @@
     <entry file="file://$PROJECT_DIR$/train/data_rgbt.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="34">
-          <caret line="2" column="10" lean-forward="true" selection-start-line="2" selection-start-column="10" selection-end-line="2" selection-end-column="10" />
+          <caret line="2" column="10" selection-start-line="2" selection-start-column="10" selection-end-line="2" selection-end-column="10" />
         </state>
       </provider>
     </entry>
@@ -659,7 +664,7 @@
     <entry file="file://$PROJECT_DIR$/tracking/SiamRPNEval.py">
       <provider selected="true" editor-type-id="text-editor">
         <state relative-caret-position="102">
-          <caret line="125" column="18" lean-forward="true" selection-start-line="125" selection-start-column="18" selection-end-line="125" selection-end-column="18" />
+          <caret line="125" column="18" selection-start-line="125" selection-start-column="18" selection-end-line="125" selection-end-column="18" />
           <folding>
             <element signature="e#0#10#0" expanded="true" />
             <element signature="e#818#3658#0" />
@@ -679,18 +684,41 @@
     </entry>
     <entry file="file://$PROJECT_DIR$/tracking/run_tracking.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="238">
-          <caret line="14" column="38" lean-forward="true" selection-start-line="14" selection-start-column="38" selection-end-line="14" selection-end-column="38" />
+        <state relative-caret-position="272">
+          <caret line="16" selection-start-line="10" selection-start-column="3" selection-end-line="16" />
           <folding>
             <element signature="e#0#38#0" expanded="true" />
           </folding>
         </state>
       </provider>
     </entry>
+    <entry file="file://$PROJECT_DIR$/train/experimentrgbt.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="230">
+          <caret line="158" column="12" selection-start-line="158" selection-start-column="12" selection-end-line="158" selection-end-column="12" />
+          <folding>
+            <element signature="e#0#64#0" expanded="true" />
+          </folding>
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/tracking/network.py">
+      <provider selected="true" editor-type-id="text-editor">
+        <state relative-caret-position="323">
+          <caret line="64" column="30" selection-start-line="64" selection-start-column="30" selection-end-line="64" selection-end-column="30" />
+          <folding>
+            <element signature="e#0#12#0" expanded="true" />
+          </folding>
+        </state>
+      </provider>
+    </entry>
+    <entry file="file://$PROJECT_DIR$/experiments/SiamRPN_RGB/train_val_plot.png">
+      <provider selected="true" editor-type-id="images" />
+    </entry>
     <entry file="file://$PROJECT_DIR$/train/net.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="-499">
-          <caret line="186" column="25" lean-forward="true" selection-start-line="186" selection-start-column="25" selection-end-line="186" selection-end-column="25" />
+        <state relative-caret-position="253">
+          <caret line="95" selection-start-line="95" selection-end-line="98" selection-end-column="82" />
           <folding>
             <element signature="e#0#9#0" expanded="true" />
           </folding>
@@ -699,8 +727,11 @@
     </entry>
     <entry file="file://$PROJECT_DIR$/train/train.py">
       <provider selected="true" editor-type-id="text-editor">
-        <state relative-caret-position="340">
-          <caret line="20" lean-forward="true" selection-start-line="20" selection-end-line="20" />
+        <state relative-caret-position="338">
+          <caret line="49" column="60" lean-forward="true" selection-start-line="49" selection-start-column="60" selection-end-line="49" selection-end-column="60" />
+          <folding>
+            <element signature="e#24#33#0" expanded="true" />
+          </folding>
         </state>
       </provider>
     </entry>
diff --git a/train/train.py b/train/train.py
index c0a9d8d..c7d5b34 100644
--- a/train/train.py
+++ b/train/train.py
@@ -6,18 +6,23 @@ import argparse
 import numpy as np
 from tqdm import tqdm
 from config import config
-
+import shutil
 
 from data_rgbt import TrainDataLoaderRGBT
 from torch.utils.data import DataLoader
 
 from util import util, AverageMeter, SavePlot
 from got10k.datasets import ImageNetVID, GOT10k
-from torchvision import datasets, transforms, utils
+from torchvision import datasets, transforms
 from custom_transforms import Normalize, ToTensor, RandomStretch, RandomCrop, CenterCrop, RandomBlur, ColorAug
 from experimentrgbt import RGBTSequence
 
 import net
+import tracking
+import train
+
+# from train.experimentrgbt import ExperimentRGBT
+
 
 import wandb
 
@@ -32,6 +37,60 @@ parser.add_argument('--modality', default=None, type=int, help='how many modalit
 parser.add_argument('--model', default='SiamRPN', type=str, help='which model to use', choices=['SiamRPN'])
 
 
+
+
+def plot_curves(modality, net_path):
+
+
+    if modality == 1:
+        experiment_name = 'RGB'
+    else:
+        experiment_name = 'RGBIR'
+
+    tracker = tracking.SiamRPNEval.TrackerSiamRPNEval(modality=modality,
+                                 model_path=net_path)
+
+    experiment_val = train.experimentrgbt.ExperimentRGBT('/home/zuern/datasets/thermal_tracking/RGB-T234/',
+                                 experiment_name=experiment_name,
+                                 subset='val')
+
+
+    # remove sequences report dir and results dir:
+    if os.path.exists(experiment_val.result_dir):
+        shutil.rmtree(experiment_val.result_dir)
+    if os.path.exists(experiment_val.report_dir):
+        shutil.rmtree(experiment_val.report_dir)
+
+    experiment_val.run(tracker)
+    performance = experiment_val.report([tracker.name], return_report=True)
+
+    wandb.log({"Success curve train": wandb.Histogram(performance[tracker.name]['overall']['succ_curve']),
+               "AO train": performance[tracker.name]['overall']['ao'],
+               "SR train": performance[tracker.name]['overall']['sr']},
+              )
+
+
+
+    experiment_train = ExperimentRGBT('/home/zuern/datasets/thermal_tracking/RGB-T234/',
+                                 experiment_name=experiment_name,
+                                 subset='val')
+
+
+    # remove sequences report dir and results dir:
+    if os.path.exists(experiment_train.result_dir):
+        shutil.rmtree(experiment_train.result_dir)
+    if os.path.exists(experiment_train.report_dir):
+        shutil.rmtree(experiment_train.report_dir)
+
+    experiment_train.run(tracker)
+    performance = experiment_train.report([tracker.name], return_report=True)
+
+    wandb.log({"Success curve train": wandb.Histogram(performance[tracker.name]['overall']['succ_curve']),
+               "AO train": performance[tracker.name]['overall']['ao'],
+               "SR train": performance[tracker.name]['overall']['sr']},
+              )
+
+
 def main():
 
     '''parameter initialization'''
@@ -131,12 +190,10 @@ def main():
 
 
     train_closses, train_rlosses, train_tlosses = AverageMeter(), AverageMeter(), AverageMeter()
-    train_losses = AverageMeter()
     val_closses, val_rlosses, val_tlosses = AverageMeter(), AverageMeter(), AverageMeter()
-    val_losses = AverageMeter()
 
-    train_val_plot = SavePlot(exp_name_dir, 'train_val_plot')
 
+    train_val_plot = SavePlot(exp_name_dir, 'train_val_plot')
 
     for epoch in range(config.epoches):
 
@@ -149,24 +206,27 @@ def main():
 
             for i, dataset in enumerate(train_loader):
 
-                if args.model == 'SiamRPN':
+                if i > 100:
+                    break
+
 
-                    closs, rloss, loss = model.step(epoch, dataset,anchors, i,  train=True)
-                    closs_ = closs.cpu().item()
+                closs, rloss, loss = model.step(epoch, dataset,anchors, i,  train=True)
+                closs_ = closs.cpu().item()
 
-                    if np.isnan(closs_):
-                       sys.exit(0)
+                if np.isnan(closs_):
+                   sys.exit(0)
 
-                    train_closses.update(closs.cpu().item())
-                    train_rlosses.update(rloss.cpu().item())
-                    train_tlosses.update(loss.cpu().item())
+                train_closses.update(closs.cpu().item())
+                train_rlosses.update(rloss.cpu().item())
+                train_tlosses.update(loss.cpu().item())
 
-                    progbar.set_postfix(closs='{:05.3f}'.format(train_closses.avg),
-                                        rloss='{:05.5f}'.format(train_rlosses.avg),
-                                        tloss='{:05.3f}'.format(train_tlosses.avg))
+                progbar.set_postfix(closs='{:05.3f}'.format(train_closses.avg),
+                                    rloss='{:05.5f}'.format(train_rlosses.avg),
+                                    tloss='{:05.3f}'.format(train_tlosses.avg))
+
+                progbar.update()
+                train_loss.append(train_tlosses.avg)
 
-                    progbar.update()
-                    train_loss.append(train_tlosses.avg)
 
         print('saving model')
         model.save(model, exp_name_dir, epoch)
@@ -183,27 +243,25 @@ def main():
 
             for i, dataset in enumerate(val_loader):
 
-                if args.model == 'SiamRPN':
-
-                    val_closs, val_rloss, val_tloss = model.step(epoch, dataset, anchors, train=False)
-                    closs_ = val_closs.cpu().item()
+                val_closs, val_rloss, val_tloss = model.step(epoch, dataset, anchors, train=False)
+                closs_ = val_closs.cpu().item()
 
-                    if np.isnan(closs_):
-                        sys.exit(0)
+                if np.isnan(closs_):
+                    sys.exit(0)
 
-                    val_closses.update(val_closs.cpu().item())
-                    val_rlosses.update(val_rloss.cpu().item())
-                    val_tlosses.update(val_tloss.cpu().item())
+                val_closses.update(val_closs.cpu().item())
+                val_rlosses.update(val_rloss.cpu().item())
+                val_tlosses.update(val_tloss.cpu().item())
 
-                    progbar.set_postfix(closs='{:05.3f}'.format(val_closses.avg),
-                                        rloss='{:05.5f}'.format(val_rlosses.avg),
-                                        tloss='{:05.3f}'.format(val_tlosses.avg))
-                    progbar.update()
+                progbar.set_postfix(closs='{:05.3f}'.format(val_closses.avg),
+                                    rloss='{:05.5f}'.format(val_rlosses.avg),
+                                    tloss='{:05.3f}'.format(val_tlosses.avg))
+                progbar.update()
 
-                    val_loss.append(val_tlosses.avg)
+                val_loss.append(val_tlosses.avg)
 
-                    if i >= config.val_epoch_size - 1:
-                        break
+                if i >= config.val_epoch_size - 1:
+                    break
 
 
         val_loss = np.mean(val_loss)
@@ -214,24 +272,15 @@ def main():
         wandb.log({'Train loss': train_loss,
                    'Val loss': val_loss})
 
-        # # Get curves of training
-        # net_path = os.path.join('{}/model'.format(exp_name_dir), 'model_e%d.pth' % (epoch + 1))
-        # tracker = TrackerSiamRPNBIG(params, net_path)
-        #
-        # # remove sequences report dir and results dir:
-        # if os.path.exists(experiment.result_dir):
-        #     shutil.rmtree(experiment.result_dir)
-        # if os.path.exists(experiment.report_dir):
-        #     shutil.rmtree(experiment.report_dir)
-        #
-        # experiment.run(tracker)
-        # performance = experiment.report([tracker.name])
-        #
-        # wandb.log({"Success_curve": wandb.Histogram(performance[tracker.name]['overall']['succ_curve']),
-        #            "AO": performance[tracker.name]['overall']['ao'],
-        #            "SR": performance[tracker.name]['overall']['sr'],
-        #            "FPS": performance[tracker.name]['overall']['speed_fps']},
-        #           )
+
+
+        model_save_dir_pth = '{}/model'.format(exp_name_dir)
+        if not os.path.exists(model_save_dir_pth):
+                os.makedirs(model_save_dir_pth)
+        net_path = os.path.join(model_save_dir_pth, 'model_e%d.pth' % (epoch + 1))
+
+
+        plot_curves(args.modality, net_path)
 
 
 if __name__ == '__main__':
